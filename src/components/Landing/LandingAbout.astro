---
import LandingStatsSlideshow from "@/components/Landing/LandingStatsSlideshow";

import Container from "@/components/Common/Container";
import { getCollection } from "astro:content";
import SimpleSection from "../Common/SimpleSection";

const allEvents = await getCollection("events");
const venues = await getCollection("venues");

// Filter out dev-only events and test events for production
const realEvents = allEvents.filter(
  (event) => !event.data.devOnly && !event.id.startsWith("999999"),
);

// Calculate stats
const totalEvents = realEvents.length;
const uniqueVenues = venues.filter((venue) => !venue.id.startsWith("999999")).length;
---

<Container>
  <div class="flex flex-col items-center justify-center gap-20 lg:flex-row">
    <div class="h-90 w-90">
      <LandingStatsSlideshow client:visible totalEvents={totalEvents} uniqueVenues={uniqueVenues} />
    </div>

    <div class="flex max-w-xl flex-col gap-8 text-center">
      <SimpleSection
        title="About OKTech"
        button={{ text: "Learn More", href: "/about", ariaLabel: "Learn More About OKTech" }}
      >
        <p class="text-lg">
          A volunteer, non-profit group organizing monthly meetups in the Kansai region of Japan. We
          invite people from all walks of web-life and encourage members to present topics they
          enjoy. Join us for technical workshops, study sessions, and social gatherings in Osaka and
          Kyoto.
        </p>
      </SimpleSection>
    </div>
  </div>
</Container>
